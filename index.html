<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>incre_ment | terminal_v1.0</title>
  <style>
    :root {
      --bg-color: #0a0a0a;
      --card-bg: #111;
      --border-color: #222;
      --text-main: #f0f0f0;
      --text-dim: #888;
      --text-accent: #ccc;
    }

    body { 
      background-color: var(--bg-color); 
      color: var(--text-main); 
      font-family: sans-serif; 
      margin: 0; 
      padding: 40px 20px; 
      /* Subtle scanline effect across the whole page */
      background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), var(--bg-color);
      background-size: 100% 4px;
    }

    /* Header & Terminal Metadata */
    header { text-align: center; margin-bottom: 80px; position: relative; }
    
    h1 { 
      font-weight: 200; 
      letter-spacing: 12px; 
      text-transform: uppercase; 
      margin-bottom: 12px; 
      color: var(--text-main);
    }
    
    .header-metadata {
      font-family: monospace;
      font-size: 0.7rem;
      color: var(--text-dim);
      letter-spacing: 2px;
      word-spacing: 5px;
      text-transform: uppercase;
    }

    .status-active {
      color: var(--text-accent);
      font-weight: bold;
      animation: pulse 3s infinite ease-in-out;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
    
    /* Gallery Grid with Corner Brackets */
    .gallery { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); 
      gap: 40px; 
      max-width: 1400px; 
      margin: 0 auto; 
      padding: 20px;
      border-left: 1px solid var(--border-color);
      border-right: 1px solid var(--border-color);
      position: relative;
    }

    /* Decorative Corner Brackets */
    .gallery::before, .gallery::after {
      content: "[ ]";
      position: absolute;
      font-family: monospace;
      color: #333;
      font-size: 1.2rem;
    }
    .gallery::before { top: -10px; left: -5px; }
    .gallery::after { bottom: -10px; right: -5px; }

    /* Card Styling */
    .card { 
      background: var(--card-bg); 
      border: 1px solid var(--border-color); 
      border-radius: 2px; 
      overflow: hidden; 
      display: flex; 
      flex-direction: column; 
      position: relative;
    }

    /* Top 'Bit-Stream' bar */
    .card::before {
      content: "";
      position: absolute;
      top: 0; left: 0; width: 100%; height: 1px;
      background: #444;
      z-index: 10;
    }
    
    canvas { 
      width: 100%; 
      aspect-ratio: 16 / 9; 
      display: block; 
      background-color: #000;
      filter: brightness(0.9) contrast(1.1); /* Gritty aesthetic */
    }
    
    .card-info { padding: 18px; border-top: 1px solid var(--border-color); position: relative; }
    
    .card-title { 
      font-family: monospace;
      font-size: 0.75rem; 
      margin: 0; 
      color: #aaa; 
      letter-spacing: 1px; 
    }

    .card-link {
      display: inline-block;
      margin-top: 10px;
      font-size: 0.65rem;
      color: #555;
      text-decoration: none;
      letter-spacing: 1px;
      text-transform: uppercase;
      transition: color 0.3s ease;
    }

    .card-link:hover { color: var(--text-main); }

    /* Performance Metrics Overlay */
    .fps-counter {
      position: absolute;
      top: 18px;
      right: 18px;
      font-family: monospace;
      font-size: 0.65rem;
      color: #666;
      opacity: 0.8;
      letter-spacing: 0.5px;
    }
  </style>
</head>
<body>

  <header>
    <h1>incre_ment</h1>
    <div class="header-metadata">
      SYS_ID: <span class="status-active">INC_RE_001</span> // 
      GPU_LOAD: STABLE // 
      NODES: <span id="node-count">00</span> // 
      <span id="current-date">0000.00.00</span>
    </div>
  </header>

  <main class="gallery">
    <div class="card">
      <canvas id="canvas-triangles"></canvas>
      <div class="card-info">
        <p class="card-title">MEM_ADDR: 0x001 // TRI_LOADER</p>
        <div class="fps-counter" id="fps-canvas-triangles">-- FPS · --ms</div>
        <a href="https://www.shadertoy.com/view/lc3cRN" target="_blank" class="card-link">SRC_FILE →</a>
      </div>
    </div>

    <div class="card">
      <canvas id="canvas-tunnel"></canvas>
      <div class="card-info">
        <p class="card-title">MEM_ADDR: 0x002 // CONDUIT_MKII</p>
        <div class="fps-counter" id="fps-canvas-tunnel">-- FPS · --ms</div>
        <a href="https://www.shadertoy.com/view/Wc3yRr" target="_blank" class="card-link">SRC_FILE →</a>
      </div>
    </div>

    <div class="card">
      <canvas id="canvas-noiserings"></canvas>
      <div class="card-info">
        <p class="card-title">MEM_ADDR: 0x003 // NOISE_GEN_V3</p>
        <div class="fps-counter" id="fps-canvas-noiserings">-- FPS · --ms</div>
        <a href="https://www.shadertoy.com/view/M3XBz4" target="_blank" class="card-link">SRC_FILE →</a>
      </div>
    </div>

    <div class="card">
      <canvas id="canvas-starfield"></canvas>
      <div class="card-info">
         <p class="card-title">MEM_ADDR: 0x004 // RIPPLE_PROC</p>
         <div class="fps-counter" id="fps-canvas-starfield">-- FPS · --ms</div>
         <a href="https://www.shadertoy.com/view/43lyzH" target="_blank" class="card-link">SRC_FILE →</a>
      </div>
    </div>
  </main>

  <script type="module">
    // --- System Metadata Initialization ---
    const dateDisplay = document.getElementById('current-date');
    const nodeDisplay = document.getElementById('node-count');
    
    // Auto-Date
    const now = new Date();
    dateDisplay.innerText = `${now.getFullYear()}.${String(now.getMonth()+1).padStart(2,'0')}.${String(now.getDate()).padStart(2,'0')}`;

    // Auto-Node Count
    const totalNodes = document.querySelectorAll('.card').length;
    nodeDisplay.innerText = String(totalNodes).padStart(2, '0');

    // --- Master Shader Engine ---
    async function initShader(canvasId, fragFileName) {
      const canvas = document.getElementById(canvasId);
      const fpsDisplay = document.getElementById(`fps-${canvasId}`);
      const gl = canvas.getContext('webgl');
      if (!gl) return;

      const response = await fetch(`shaders/${fragFileName}`);
      const fragmentSource = await response.text();
      const vertexSource = `attribute vec2 position; void main() { gl_Position = vec4(position, 0.0, 1.0); }`;

      function createShader(gl, type, source) {
        const s = gl.createShader(type);
        gl.shaderSource(s, source);
        gl.compileShader(s);
        if (!gl.getShaderParameter(s, gl.COMPILE_STATUS)) console.error(gl.getShaderInfoLog(s));
        return s;
      }

      const program = gl.createProgram();
      gl.attachShader(program, createShader(gl, gl.VERTEX_SHADER, vertexSource));
      gl.attachShader(program, createShader(gl, gl.FRAGMENT_SHADER, fragmentSource));
      gl.linkProgram(program);
      gl.useProgram(program);

      const buffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1, 1,-1, -1,1, -1,1, 1,-1, 1,1]), gl.STATIC_DRAW);
      const pos = gl.getAttribLocation(program, "position");
      gl.enableVertexAttribArray(pos);
      gl.vertexAttribPointer(pos, 2, gl.FLOAT, false, 0, 0);

      const timeLoc = gl.getUniformLocation(program, "u_time");
      const resLoc = gl.getUniformLocation(program, "u_resolution");

      let lastTime = 0;
      let frameCount = 0;
      let lastFpsUpdate = 0;

      function render(time) {
        const deltaTime = time - lastTime;
        lastTime = time;
        frameCount++;

        if (time - lastFpsUpdate > 500) {
          const fps = Math.round((frameCount * 1000) / (time - lastFpsUpdate));
          const avgTime = deltaTime.toFixed(1);
          fpsDisplay.innerText = `${fps} FPS · ${avgTime}ms`;
          fpsDisplay.style.opacity = fps < 45 ? "0.4" : "0.8";
          lastFpsUpdate = time;
          frameCount = 0;
        }

        if (canvas.width !== canvas.clientWidth || canvas.height !== canvas.clientHeight) {
          canvas.width = canvas.clientWidth;
          canvas.height = canvas.clientHeight;
        }
        gl.viewport(0, 0, canvas.width, canvas.height);
        gl.uniform1f(timeLoc, time * 0.001);
        gl.uniform2f(resLoc, canvas.width, canvas.height);
        gl.drawArrays(gl.TRIANGLES, 0, 6);
        requestAnimationFrame(render);
      }
      requestAnimationFrame(render);
    }

    // --- Boot Sequence ---
    initShader('canvas-triangles', 'triangles.frag');
    initShader('canvas-tunnel', 'tunnel.frag'); 
    initShader('canvas-noiserings', 'noiseRings.frag');
    initShader('canvas-starfield', 'starfield.frag');
  </script>
</body>
</html>
